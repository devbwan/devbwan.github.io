__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,'__esModule',{value:!0}),Object.defineProperty(e,"mergeGuestDataToUser",{enumerable:!0,get:function(){return n}});var t=r(d[0]),s=r(d[1]),o=r(d[2]);const n=async n=>{if(!n)throw new Error('\uc0ac\uc6a9\uc790 ID\uac00 \ud544\uc694\ud569\ub2c8\ub2e4.');const l={sessionsMerged:0,rewardsMerged:0,errors:[]};try{const u=await(0,t.getRunningSessions)(null,1e3);if(u.length>0){console.log(`[Guest Merge] \uac8c\uc2a4\ud2b8 \uc138\uc158 ${u.length}\uac1c \ubc1c\uacac`);for(const s of u)try{await(0,t.updateSessionUserId)(s.id,n);try{const t=await c(s.id);await(0,o.syncRunningSession)({userId:n,type:s.type||'solo',distance:s.distance||0,duration:s.duration||0,avgPace:s.avg_pace||null,maxSpeed:s.max_speed||null,calories:s.calories||null,cadence:s.cadence||null,startTime:s.start_time||Math.floor(Date.now()/1e3),endTime:s.end_time||Math.floor(Date.now()/1e3)},t||[])}catch(t){console.warn(`[Guest Merge] \uc138\uc158 ${s.id} \ud074\ub77c\uc6b0\ub4dc \ub3d9\uae30\ud654 \uc2e4\ud328:`,t)}l.sessionsMerged++}catch(t){console.error(`[Guest Merge] \uc138\uc158 ${s.id} \ubcd1\ud569 \uc2e4\ud328:`,t),l.errors.push(`\uc138\uc158 ${s.id}: ${t.message}`)}console.log(`[Guest Merge] \uc138\uc158 \ubcd1\ud569 \uc644\ub8cc: ${l.sessionsMerged}\uac1c`)}const w=await(0,s.getUserRewards)(null);if(w.length>0){console.log(`[Guest Merge] \uac8c\uc2a4\ud2b8 \uba54\ub2ec ${w.length}\uac1c \ubc1c\uacac`);for(const t of w)try{await(0,s.saveReward)(n,t.id),l.rewardsMerged++}catch(s){console.error(`[Guest Merge] \uba54\ub2ec ${t.id} \ubcd1\ud569 \uc2e4\ud328:`,s),l.errors.push(`\uba54\ub2ec ${t.id}: ${s.message}`)}console.log(`[Guest Merge] \uba54\ub2ec \ubcd1\ud569 \uc644\ub8cc: ${l.rewardsMerged}\uac1c`)}return l}catch(t){throw console.error('[Guest Merge] \ub370\uc774\ud130 \ubcd1\ud569 \uc911 \uc624\ub958:',t),t}},c=async t=>{try{const{getDatabase:s}=await r(d[4])(d[3],d.paths,"../db/database"),{Platform:o}=await r(d[4])(d[5],d.paths,"react-native"),n=(await r(d[4])(d[6],d.paths,"@react-native-async-storage/async-storage")).default;{const s=`@runwave_routes_${t}`,o=await n.getItem(s);return o?JSON.parse(o):[]}}catch(t){return console.error('\uacbd\ub85c \ub370\uc774\ud130 \uac00\uc838\uc624\uae30 \uc2e4\ud328:',t),[]}}},1441,{"0":971,"1":967,"2":987,"3":964,"4":954,"5":443,"6":940,"paths":{}});